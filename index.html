<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accueil - DTM UGB</title>

    <!-- Design & Police -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {dtm: {light: '#e0f2fe', primary: '#0284c7', dark: '#0c4a6e'}},
                    fontFamily: {sans: ['Montserrat', 'sans-serif']},
                    animation: {
                        'fade-in-up': 'fadeInUp 0.8s ease-out forwards',
                    },
                    keyframes: {
                        fadeInUp: {'0%': {opacity: '0', transform: 'translateY(20px)'}, '100%': {opacity: '1', transform: 'translateY(0)'}},
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #f8fafc;
        }

        .hero-bg {
            background-image: url('https://images.unsplash.com/photo-1638202993928-7267aad84c31?q=80&w=1920');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            position: relative;
        }

        .blue-overlay {
            /* Dégradé foncé pour un look plus premium */
            background: linear-gradient(to bottom, rgba(2, 132, 199, 0.95), rgba(12, 74, 110, 0.98));
            position: absolute;
            inset: 0;
        }

        /* Styles des tuiles d'information */
        .info-box {
            @apply bg-white p-6 rounded-xl shadow-lg border border-gray-100 transition-transform duration-300 hover:shadow-xl hover:-translate-y-1;
        }
    </style>
</head>

<body>

    <!-- MODALE ALERTE -->
    <div id="alertModal"
        class="fixed inset-0 z-[200] hidden flex items-center justify-center bg-black/50 backdrop-blur-sm transition-opacity">
        <div
            class="bg-white rounded-3xl shadow-2xl p-8 max-w-xs w-full text-center transform scale-100 transition-transform relative">
            <div id="alertIcon" class="mx-auto w-16 h-16 rounded-full flex items-center justify-center mb-4 shadow-sm">
                <!-- Icone dynamique -->
            </div>
            <h3 id="alertTitle" class="text-xl font-bold text-gray-800 mb-2">Message</h3>
            <p id="alertMessage" class="text-gray-500 text-sm mb-6 leading-relaxed">Corps du message.</p>
            <button onclick="document.getElementById('alertModal').classList.add('hidden')"
                class="w-full px-6 py-2.5 rounded-xl bg-dtm-primary text-white font-bold hover:bg-blue-600 transition-colors">OK</button>
        </div>
    </div>
    <!-- FIN MODALE ALERTE -->


    <nav class="fixed w-full z-50 top-0 start-0 bg-white/95 backdrop-blur-md border-b shadow-md transition-all">
        <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto px-4 py-2">

            <!-- LOGO NAV -->
            <a href="index.html" class="flex items-center space-x-3 group">
                <img src="logo.png" class="h-14 md:h-20 w-auto transition-transform group-hover:scale-105"
                    alt="DTM Logo" onerror="this.src='https://placehold.co/50x50/0284c7/ffffff?text=DTM'">
                <span class="self-center text-xl md:text-2xl font-bold text-dtm-dark hidden sm:block">DTM UGB</span>
            </a>

            <div class="flex md:order-2 items-center gap-4 md:gap-3">

                <!-- ICONES MOBILES -->
                <div class="flex items-center gap-5 md:hidden">
                    <a href="apropos.html" class="text-gray-500 hover:text-dtm-primary transition-colors"
                        aria-label="À propos">
                        <i class="fa-solid fa-circle-info text-2xl"></i>
                    </a>
                    <a href="#news" class="text-gray-500 hover:text-dtm-primary transition-colors"
                        aria-label="Actualités">
                        <i class="fa-solid fa-newspaper text-2xl"></i>
                    </a>
                </div>

                <a href="admin.html"
                    class="hidden md:flex text-gray-500 hover:text-dtm-dark font-medium text-sm px-3 py-2 transition-colors items-center">
                    <i class="fa-solid fa-user-shield mr-2"></i> Admin
                </a>

                <button onclick="document.getElementById('navbar').classList.toggle('hidden')"
                    class="md:hidden p-2 text-gray-500 rounded-lg hover:bg-gray-100 focus:ring-2 focus:ring-gray-200"
                    aria-label="Menu">
                    <i class="fa-solid fa-bars text-2xl"></i>
                </button>
            </div>

            <div class="hidden w-full md:flex md:w-auto md:order-1" id="navbar">
                <ul
                    class="flex flex-col p-4 md:p-0 mt-4 font-medium md:flex-row md:space-x-8 md:mt-0 items-center bg-white md:bg-transparent rounded-xl md:rounded-none border md:border-none border-gray-100 shadow-lg md:shadow-none">

                    <li><a href="#"
                            class="block py-2 px-3 text-dtm-primary font-bold border-b-2 border-dtm-primary md:border-0">Accueil</a>
                    </li>
                    <li class="hidden md:block">
                        <a href="apropos.html"
                            class="block py-2 px-3 text-gray-700 hover:text-dtm-primary transition-colors">À Propos</a>
                    </li>
                    <li><a href="#news"
                            class="block py-2 px-3 text-gray-700 hover:text-dtm-primary transition-colors">Actualités</a>
                    </li>

                    <li>
                        <a href="https://www.xassidacloud.com" target="_blank"
                            class="block py-2 px-3 text-gray-700 hover:text-dtm-primary transition-colors">
                            XassidaCloud
                        </a>
                    </li>

                    <li class="md:hidden w-full text-center border-t border-gray-100 mt-2 pt-2">
                        <a href="admin.html" class="block py-2 px-3 text-gray-500 hover:text-dtm-dark">
                            <i class="fa-solid fa-user-shield mr-1"></i> Espace Admin
                        </a>
                    </li>

                    <li class="mt-4 md:mt-0">
                        <button onclick="checkAccess()"
                            class="block py-2 px-6 md:px-4 text-white bg-dtm-primary hover:bg-dtm-dark rounded-full transition-all shadow-md transform hover:scale-105 w-full md:w-auto">
                            <i class="fa-solid fa-user-circle mr-2"></i>Mon Profil
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 1. HERO SECTION (Améliorée) -->
    <header class="hero-bg min-h-screen flex items-center justify-center pt-24 pb-20 px-4 relative">
        <div class="blue-overlay"></div>
        <div class="text-center max-w-5xl relative z-10 text-white animate-fade-in-up">

            <h1 class="text-5xl md:text-8xl font-extrabold mb-6 tracking-tight leading-none drop-shadow-xl">
                Dahira Touba <br><span class="text-blue-300">Médecine</span>
            </h1>
            <p class="text-xl md:text-2xl text-blue-100/90 mb-12 font-medium max-w-4xl mx-auto drop-shadow-md">
                Union, Solidarité et Excellence. Notre devoir est de servir la communauté estudiantine de l'UGB.
            </p>

            <div class="flex flex-col sm:flex-row justify-center gap-4 md:gap-6 w-full max-w-lg mx-auto">
                <a href="inscription.html"
                    class="px-8 py-4 bg-dtm-light text-dtm-dark hover:bg-white text-lg font-bold rounded-full shadow-2xl transition-transform hover:scale-105 flex items-center justify-center border border-dtm-dark">
                    <i class="fa-solid fa-user-plus mr-2"></i> S'inscrire
                </a>
                <a href="connexion.html"
                    class="px-8 py-4 bg-transparent border-2 border-white text-white hover:bg-white/20 text-lg font-bold rounded-full shadow-2xl transition-transform hover:scale-105 flex items-center justify-center">
                    <i class="fa-solid fa-right-to-bracket mr-2"></i> Se connecter
                </a>
            </div>

        </div>
    </header>

    <!-- 2. SECTION A PROPOS -->
    <section id="about" class="py-24 bg-white">
        <div class="max-w-7xl mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-extrabold text-gray-800 uppercase tracking-wide">NOTRE MISSION & ENGAGEMENT
                </h2>
                <div class="w-24 h-1.5 bg-dtm-primary mx-auto mt-4 rounded-full"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                <div class="order-2 md:order-1">
                    <p class="text-gray-600 leading-relaxed text-lg mb-6 text-justify">
                        Le <strong>Dahira Touba Médecine (DTM)</strong> est une structure regroupant les étudiants et
                        professionnels de santé mourides de l'Université Gaston Berger.
                        Guidés par les enseignements de Cheikh Ahmadou Bamba, nous œuvrons pour l'excellence académique
                        et l'entraide sociale.
                    </p>
                    <ul class="space-y-3 text-gray-700 mb-8">
                        <li class="flex items-center"><i class="fa-solid fa-check-circle text-dtm-primary mr-3"></i>
                            Accompagnement pédagogique</li>
                        <li class="flex items-center"><i class="fa-solid fa-check-circle text-dtm-primary mr-3"></i>
                            Actions sociales et médicales</li>
                        <li class="flex items-center"><i class="fa-solid fa-check-circle text-dtm-primary mr-3"></i>
                            Activités culturelles et religieuses</li>
                    </ul>
                    <a href="apropos.html"
                        class="inline-block border-2 border-dtm-dark text-dtm-dark hover:bg-dtm-dark hover:text-white font-bold py-3 px-8 rounded-full transition-all">
                        En savoir plus
                    </a>
                </div>
                <div class="order-1 md:order-2 flex justify-center">
                    <div
                        class="relative w-full max-w-sm aspect-square bg-dtm-light rounded-full flex items-center justify-center p-8 shadow-inner">
                        <img src="logo.png" class="w-3/4 h-auto drop-shadow-2xl"
                            onerror="this.src='https://cdn-icons-png.flaticon.com/512/1034/1034179.png'" alt="Logo DTM">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 3. SECTION ACTUALITÉS -->
    <section id="news" class="py-20 bg-gray-50 border-t border-gray-100">
        <div class="max-w-7xl mx-auto px-6">
            <div class="flex justify-between items-end mb-12">
                <div>
                    <h2 class="text-3xl font-bold text-dtm-dark uppercase tracking-wide">Dernières Actualités</h2>
                    <div class="w-20 h-1 bg-dtm-primary mx-auto mt-2 rounded-full"></div>
                </div>
                <a href="actualites.html" class="text-dtm-primary font-bold hover:underline hidden sm:block">Voir tout
                    <i class="fa-solid fa-arrow-right ml-1"></i></a>
            </div>

            <div id="homeNewsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Chargement des actualités ici -->
                <div class="col-span-full text-center py-10 text-gray-400">
                    <i class="fa-solid fa-circle-notch fa-spin text-3xl mb-2"></i><br>Chargement des infos...
                </div>
            </div>

            <div class="text-center mt-10 sm:hidden">
                <a href="actualites.html"
                    class="inline-block bg-dtm-light text-dtm-dark font-bold py-3 px-8 rounded-full">Voir toutes les
                    actualités</a>
            </div>
        </div>
    </section>

    <footer class="bg-dtm-dark text-white py-8 text-center">
        <p class="text-sm opacity-80">
            © 2025 Dahira Touba Médecine UGB.
            <span class="hidden sm:inline">|</span>
            <br class="sm:hidden">
            <a href="mailto:dtm.ugb@gmail.com" class="text-white hover:text-dtm-light transition-colors font-medium">
                dtm.ugb@gmail.com
            </a>
        </p>
    </footer>

    <script type="module">
        import {initializeApp} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import {getFirestore, collection, getDocs, query, limit} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // VOS CLES (DTM-UGB-Officiel)
        const firebaseConfig = {apiKey: "AIzaSyC9O7wvG2s-teRO5IehT5K1ozJ48S2nDDo", authDomain: "dtm-ugb-officiel.firebaseapp.com", projectId: "dtm-ugb-officiel", storageBucket: "dtm-ugb-officiel.firebasestorage.app", messagingSenderId: "871436265978", appId: "1:871436265978:web:98bf9fb593bd6e46e3dc43", measurementId: "G-1P30LZJHYJ"};
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- FONCTION MODALE ALERTE (Pour remplacer le popup) ---
        function showAlertModal(type, message, redirect = false) {
            const modal = document.getElementById('alertModal');
            const iconDiv = modal.querySelector('#alertIcon');
            const title = modal.querySelector('#alertTitle');
            const msg = modal.querySelector('#alertMessage');
            const button = modal.querySelector('button');

            iconDiv.className = 'mx-auto w-16 h-16 rounded-full flex items-center justify-center mb-4 shadow-sm';

            if (type === 'success') {
                iconDiv.classList.add('bg-green-100', 'text-green-600');
                iconDiv.innerHTML = '<i class="fa-solid fa-check-circle text-3xl"></i>';
                title.innerText = "Succès !";
                button.innerText = "OK";
            } else { // Warning (Accès restreint)
                iconDiv.classList.add('bg-orange-100', 'text-orange-600');
                iconDiv.innerHTML = '<i class="fa-solid fa-lock text-3xl"></i>';
                title.innerText = "Accès Restreint";
                button.innerText = "Se connecter";
            }

            msg.innerText = message;
            modal.classList.remove('hidden');

            if (redirect) {
                // Redirection vers la page de connexion après le clic
                button.onclick = () => {
                    window.location.href = "connexion.html";
                };
            } else {
                // Ferme la modale
                button.onclick = () => {
                    modal.classList.add('hidden');
                };
            }
        }

        // --- CORRECTION DU CHARGEMENT DES ACTUALITÉS ---
        async function loadHomeNews() {
            const container = document.getElementById('homeNewsContainer');
            // Afficher le spinner avant le chargement
            container.innerHTML = `
                <div class="col-span-full text-center py-10 text-gray-400">
                    <i class="fa-solid fa-circle-notch fa-spin text-3xl mb-2"></i><br>Chargement des infos...
                </div>
            `;

            try {
                // Requête Firebase pour les 3 dernières actualités (sans ordre explicite, mais limité à 3)
                const q = query(collection(db, "actualites"), limit(3));
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    container.innerHTML = `<div class="col-span-full text-center py-10 text-gray-500 bg-white rounded-xl shadow p-6">Aucune actualité récente.</div>`;
                    return;
                }

                let contentHtml = '';

                querySnapshot.forEach((doc) => {
                    const item = doc.data();
                    const imgUrl = item.image || 'https://placehold.co/600x400?text=DTM';
                    const dateDisplay = item.date || 'N/A';
                    const categoryDisplay = item.categorie || 'Info';
                    const title = item.titre || 'Titre manquant';
                    const description = item.description || 'Pas de description.';

                    contentHtml += `
                        <a href="actualites.html?id=${doc.id}" class="info-box block h-full flex flex-col">
                            <div class="h-48 overflow-hidden relative rounded-xl mb-4 bg-gray-200">
                                <img src="${imgUrl}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105" loading="lazy">
                                <span class="absolute bottom-2 left-2 bg-dtm-primary/80 text-white text-[10px] font-bold px-2 py-1 rounded backdrop-blur-sm">${categoryDisplay}</span>
                            </div>
                            <div class="flex flex-col flex-grow">
                                <div class="text-[10px] text-gray-400 mb-2 uppercase font-bold tracking-wide">${dateDisplay}</div>
                                <h3 class="text-lg font-bold text-gray-800 mb-2 leading-tight group-hover:text-dtm-primary transition-colors line-clamp-2">${title}</h3>
                                <p class="text-gray-600 text-xs line-clamp-3 mb-4 flex-grow">${description}</p>
                                <span class="text-dtm-primary text-xs font-bold self-start mt-auto group-hover:underline">Lire l'article</span>
                            </div>
                        </a>
                    `;
                });

                container.innerHTML = contentHtml; // Injecter le contenu HTML final

            } catch (error) {
                console.error("Erreur news home:", error);
                container.innerHTML = `<div class="col-span-full text-center py-10 text-red-500 bg-white rounded-xl shadow p-6">
                    <i class="fa-solid fa-triangle-exclamation mr-2"></i> Erreur lors du chargement des actualités.
                </div>`;
                // Afficher l'alerte modale pour l'utilisateur
                showAlertModal("error", "Impossible de charger les actualités depuis le serveur.");
            }
        }

        window.checkAccess = function () {
            const user = localStorage.getItem('dtm_currentUser');
            if (user) {window.location.href = "dashboard.html";}
            else {
                // Afficher la modale d'avertissement et rediriger après confirmation
                showAlertModal(
                    "warning",
                    "Pour accéder à votre profil et carte de membre, vous devez vous connecter.",
                    true // Indique la redirection
                );
            }
        }

        loadHomeNews();
    </script>
</body>

</html>
